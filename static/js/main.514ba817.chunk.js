(this["webpackJsonpmap-to-field"]=this["webpackJsonpmap-to-field"]||[]).push([[0],{28:function(e,t,r){},29:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(2),i=r.n(a),c=r(17),o=r.n(c),u=(r(28),r(5)),s=r(1),l=r(21),f=r(12),p=r(3);r(29);var d=function(e){var t=e.id,r=e.addMapping,a=e.mailManifestHeaders,i=e.mapping;return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("select",{onChange:function(e){r(t,e.target.value)},value:i||"",children:[Object(n.jsx)("option",{value:""}),a.map((function(e){return Object(n.jsx)("option",{value:e,children:e},"option_".concat(e))}))]})})};var b=function(e){var t=e.id,r=e.addValue,a=e.value;return Object(n.jsx)("input",{type:"text",onChange:function(e){r(t,e.target.value)},value:a})};var m=function(e){var t=e.id,r=e.addMapping,i=e.addValue,c=e.isHidden,o=e.mailManifestHeaders,u=e.mapping,s=e.value,l=Object(a.useState)(""),f=Object(p.a)(l,2),m=f[0],v=f[1];return Object(n.jsxs)("td",{className:c?"":"hidden",children:[Object(n.jsxs)("select",{onChange:function(e){v(e.target.value)},value:m||"",children:[Object(n.jsx)("option",{value:""}),Object(n.jsx)("option",{value:"mapper",children:"Mapper"}),Object(n.jsx)("option",{value:"input",children:"Input"})]}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),u||"mapper"===m?Object(n.jsx)(d,{id:t,addMapping:r,mailManifestHeaders:o,mapping:u}):s||"input"===m?Object(n.jsx)(b,{id:t,addValue:i,value:s}):null]})};var v=function(e){var t=e.addMapping,r=e.addValue,a=e.mailManifestHeaders,i=e.mappings,c=e.templateHeaders,o=e.toggleColumn,u=e.values,s=e.visibilitySettings;return Object(n.jsxs)("table",{children:[Object(n.jsx)("thead",{children:Object(n.jsx)("tr",{children:c.map((function(e){return Object(n.jsxs)("td",{className:-1===s.indexOf(e)?"":"hidden",children:[Object(n.jsx)("span",{children:e}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{id:"toggle_".concat(e),type:"checkbox",onChange:o,checked:-1===s.indexOf(e)})]},"header_".concat(e))}))})}),Object(n.jsx)("tbody",{children:Object(n.jsx)("tr",{children:a.length>0&&c.map((function(e){return Object(n.jsx)(m,{id:e,addMapping:t,addValue:r,isHidden:-1===s.indexOf(e),mailManifestHeaders:a,mapping:i[e]||"",value:u[e]||""},"cell_".concat(e))}))})})]})},h=r(7),j=r.n(h),O=r(9),g=r(18);function y(e){return x.apply(this,arguments)}function x(){return(x=Object(O.a)(j.a.mark((function e(t){var r,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.loadAsync)(t);case 2:return r=e.sent,n=[],r.forEach((function(e,t){t.dir||n.push(t.name)})),a={},e.next=8,Promise.all(n.map(function(){var e=Object(O.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.file(t).async("string");case 2:return n=e.sent,e.abrupt("return",a[t]=n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=r(19),S=r.n(w),A=r(20),k=r.n(A),F={createDocument:function(e){return(new k.a.DOMParser).parseFromString(e)},select:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=S.a.useNamespaces(n);return a(r,t||e)}},M=r(22),D=r(4);function I(e,t){t&&t.epoch1904&&(e+=1462);return new Date(Math.round(24*(e-25569)*36e5))}var C={a:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",rr:"http://schemas.openxmlformats.org/package/2006/relationships"},E=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function N(e){for(var t=0,r=0;r<e.length;)t*=26,t+=E.indexOf(e[r]),r++;return t}function T(e){return e=e.split(/(\d+)/),[parseInt(e[1]),N(e[0].trim())]}function Y(e,t,r,n,a,i,c){var o=T(e.getAttribute("r")),u=r.select(t,e,"a:v",C)[0];switch(u=u&&u.textContent,e.getAttribute("t")){case"str":""===(u=u.trim())&&(u=void 0);break;case"s":""===(u=n[parseInt(u)].trim())&&(u=void 0);break;case"b":u="1"===u;break;case"n":default:if(void 0===u)break;u=parseFloat(u);var s=a[parseInt(e.getAttribute("s")||0)];(s.numberFormat.id>=14&&s.numberFormat.id<=22||s.numberFormat.id>=45&&s.numberFormat.id<=47||c.dateFormat&&s.numberFormat.template===c.dateFormat||!1!==c.smartDateParser&&s.numberFormat.template&&function(e){var t,r=e.split(/\W+/),n=Object(D.a)(r);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(["MM","DD","YY","YYYY"].indexOf(a)<0)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}(s.numberFormat.template))&&(u=I(u,i))}return void 0===u&&(u=null),{row:o[0],column:o[1],value:u}}function H(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rowMap,n=t.accessor,a=void 0===n?function(e){return e}:n,i=t.onlyTrimAtTheEnd,c=e.length-1;c>=0;){var o,u=!0,s=Object(D.a)(e[c]);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(null!==a(l)){u=!1;break}}}catch(f){s.e(f)}finally{s.f()}if(u)e.splice(c,1),r&&r.splice(c,1);else if(i)break;c--}return e}function J(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.accessor,n=void 0===r?function(e){return e}:r,a=t.onlyTrimAtTheEnd,i=e[0].length-1;i>=0;){var c,o=!0,u=Object(D.a)(e);try{for(u.s();!(c=u.n()).done;){var s=c.value;if(null!==n(s[i])){o=!1;break}}}catch(f){u.e(f)}finally{u.f()}if(o)for(var l=0;l<e.length;)e[l].splice(i,1),l++;else if(a)break;i--}return e}function _(e,t,r,n,a,i){var c=t.createDocument(e),o=t.select(c,null,"/a:worksheet/a:sheetData/a:row/a:c",C).map((function(e){return Y(e,c,t,r,n,a,i)}));if(0===o.length)return{cells:o};var u=t.select(c,null,"/a:worksheet/a:dimension/@ref",C)[0];return u?1===(u=u.textContent.split(":").map(T).map((function(e){var t=Object(p.a)(e,2);return{row:t[0],column:t[1]}}))).length&&(u=[u[0],u[0]]):u=function(e){var t=function(e,t){return e-t},r=e.map((function(e){return e.row})).sort(t),n=e.map((function(e){return e.column})).sort(t),a=r[0],i=r[r.length-1];return[{row:a,column:n[0]},{row:i,column:n[n.length-1]}]}(o),{cells:o,dimensions:u}}function P(e,t){if(!e)return[];var r=t.createDocument(e);return t.select(r,null,"//a:si",C).map((function(e){return t.select(r,e,".//a:t[not(ancestor::a:rPh)]",C).map((function(e){return e.textContent})).join("")}))}function U(e,t){if(!e)return{};var r=t.createDocument(e),n=t.select(r,null,"//a:styleSheet/a:cellStyleXfs/a:xf",C).map(z),a=t.select(r,null,"//a:styleSheet/a:numFmts/a:numFmt",C).map(V).reduce((function(e,t){return e[t.id]=t,e}),[]);return t.select(r,null,"//a:styleSheet/a:cellXfs/a:xf",C).map((function(e){return e.hasAttribute("xfId")?Object(s.a)(Object(s.a)({},n[e.xfId]),z(e,a)):z(e,a)}))}function V(e){return{id:e.getAttribute("numFmtId"),template:e.getAttribute("formatCode")}}function z(e,t){var r={};if(e.hasAttribute("numFmtId")){var n=e.getAttribute("numFmtId");t[n]?r.numberFormat=t[n]:r.numberFormat={id:n}}return r}function B(e,t){var r=t.createDocument(e),n={},a=t.select(r,null,"//a:workbookPr",C)[0];a&&"1"===a.getAttribute("date1904")&&(n.epoch1904=!0),n.sheets=[];var i,c=Object(D.a)(t.select(r,null,"//a:sheets/a:sheet",C));try{for(c.s();!(i=c.n()).done;){var o=i.value;o.getAttribute("name")&&n.sheets.push({id:o.getAttribute("sheetId"),name:o.getAttribute("name"),relationId:o.getAttribute("r:id")})}}catch(u){c.e(u)}finally{c.f()}return n}function L(e,t){var r,n=t.createDocument(e),a={sheets:{},sharedStrings:void 0,styles:void 0},i=Object(D.a)(t.select(n,null,"/rr:Relationships/rr:Relationship",C));try{for(i.s();!(r=i.n()).done;){var c=r.value,o=c.getAttribute("Target");switch(c.getAttribute("Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":a.styles=o;break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":a.sharedStrings=o;break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":a.sheets[c.getAttribute("Id")]=o}}}catch(u){i.e(u)}finally{i.f()}if(!a.styles)throw new Error('"styles.xml" file not found in the *.xlsx file');return a}function R(e,t){var r=t&&t.map((function(e,t){return'"'.concat(e.name,'" (#').concat(t+1,")")})).join(", ");return new Error("Sheet ".concat("number"===typeof e?"#"+e:'"'+e+'"'," not found in the *.xlsx file.").concat(t?" Available sheets: "+r+".":""))}function Z(){}function X(){}var q=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;function W(){}var $=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;var G={isColumnOriented:!1};function K(e,t,r){var n=r=r?Object(s.a)(Object(s.a)({},G),r):G,a=n.isColumnOriented,i=n.rowMap;!function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];if(!e[n].prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}(t),a&&(e=ne(e));for(var c=e[0],o=[],u=[],l=1;l<e.length;l++){var f=Q(t,e[l],l-1,c,u,r);f&&o.push(f)}if(i){var p,d=Object(D.a)(u);try{for(d.s();!(p=d.n()).done;){var b=p.value;b.row=i[b.row]+1}}catch(m){d.e(m)}finally{d.f()}}return{rows:o,errors:u}}function Q(e,t,r,n,a,i){for(var c={},o=function(){var o=s[u],l=e[o],f="object"===typeof l.type&&!Array.isArray(l.type),d=t[n.indexOf(o)];void 0===d&&(d=null);var b=void 0,m=void 0;if(f)b=Q(l.type,t,r,n,a,i);else if(null===d)b=null;else if(Array.isArray(l.type)){var v=!1,h=function(e){var t=[],r=0;for(;r<e.length;){var n=re(e,",",r),a=Object(p.a)(n,2),i=a[0];r+=a[1]+",".length,t.push(i.trim())}return t}(d).map((function(e){var t=ee(e,l,i);return t.error&&(b=e,m=t.error),null!==t.value&&(v=!0),t.value}));m||(b=v?h:null)}else{var j=ee(d,l,i);m=j.error,b=m?d:j.value}!m&&null===b&&l.required&&(m="required"),m?(m={error:m,row:r+1,column:o,value:b},l.type&&(m.type=l.type),a.push(m)):null!==b&&(c[l.prop]=b)},u=0,s=Object.keys(e);u<s.length;u++)o();return Object.keys(c).length>0?c:null}function ee(e,t,r){if(null===e)return{value:null};var n;if((n=t.parse?te(e,t.parse):t.type?function(e,t,r){switch(t){case String:return{value:e};case Number:case Z:return isFinite(e)&&(t!==Z||function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t}(e))?("string"===typeof e&&(e=parseFloat(e)),{value:e}):{error:"invalid"};case X:return function(e){return q.test(e)}(e)?{value:e}:{error:"invalid"};case W:return function(e){return $.test(e)}(e)?{value:e}:{error:"invalid"};case Date:if(e instanceof Date)return{value:e};if("number"===typeof e){if(!isFinite(e))return{error:"invalid"};var n=I(e=parseInt(e),r.properties);return n?{value:n}:{error:"invalid"}}return{error:"invalid"};case Boolean:return"boolean"===typeof e?{value:e}:{error:"invalid"};default:if("function"===typeof t)return te(e,t);throw new Error("Unknown schema type: ".concat(t&&t.name||t))}}(e,Array.isArray(t.type)?t.type[0]:t.type,r):{value:e}).error)return n;if(null!==n.value){if(t.oneOf&&t.oneOf.indexOf(n.value)<0)return{error:"invalid"};if(t.validate)try{t.validate(n.value)}catch(a){return{error:a.message}}}return n}function te(e,t){try{return void 0===(e=t(e))?{value:null}:{value:e}}catch(r){return{error:r.message}}}function re(e,t,r){for(var n=0,a="";r+n<e.length;){var i=e[r+n];if(i===t)return[a,n];if('"'===i){var c=re(e,'"',r+n+1);a+=c[0],n+='"'.length+c[1]+'"'.length}else a+=i,n++}return[a,n]}var ne=function(e){return e[0].map((function(t,r){return e.map((function(e){return e[r]}))}))};function ae(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r],i=e[a],c=void 0;"object"===typeof i&&(i=Object.keys(e[a])[0],c=ae(e[a][i])),t[a]={prop:i},c&&(t[a].type=c)}return t}function ie(e,t,r){var n=r.schema,a=r.map,i=Object(M.a)(r,["schema","map"]);!n&&a&&(n=ae(a));var c=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.sheet||(r=Object(s.a)({sheet:1},r));var n,a=L(e["xl/_rels/workbook.xml.rels"],t),i=P(e["xl/".concat(a.sharedStrings)],t),c=U(e["xl/".concat(a.styles)],t),o=B(e["xl/workbook.xml"],t);if(r.getSheets)return o.sheets.map((function(e){return{name:e.name}}));if("number"===typeof r.sheet){var u=o.sheets[r.sheet-1];n=u&&u.relationId}else{var l,f=Object(D.a)(o.sheets);try{for(f.s();!(l=f.n()).done;){var d=l.value;if(d.name===r.sheet){n=d.relationId;break}}}catch(C){f.e(C)}finally{f.f()}}if(!n||!a.sheets[n])throw R(r.sheet,o.sheets);var b=_(e["xl/".concat(a.sheets[n])],t,i,c,o,r);if(0===b.cells.length)return r.properties?{data:[],properties:o}:[];for(var m=Object(p.a)(b.dimensions,2),v=m[0],h=m[1],j=h.column-v.column+1,O=h.row-v.row+1,g=new Array(O),y=0;y<O;){g[y]=new Array(j);for(var x=0;x<j;)g[y][x]=null,x++;y++}var w,S=Object(D.a)(b.cells);try{for(S.s();!(w=S.n()).done;){var A=w.value,k=A.row-v.row,F=A.column-v.column;g[k][F]=A.value}}catch(C){S.e(C)}finally{S.f()}var M=r.rowMap;if(M)for(var I=0;I<g.length;)M[I]=I,I++;return g=H(J(g,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:M}),r.transformData&&(g=r.transformData(g)),r.properties?{data:g,properties:o}:g}(e,t,Object(s.a)(Object(s.a)({},i),{},{properties:n||i.properties}));return n?K(c.data,n,Object(s.a)(Object(s.a)({},i),{},{properties:c.properties})):c}function ce(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(O.a)(j.a.mark((function e(t){var r,n,a=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,y(t);case 3:return n=e.sent,e.abrupt("return",ie(n,F,r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,r){e&&t.unshift(e);var n=function(e){for(var t="object"!==typeof e?JSON.parse(e):e,r="",n=0;n<t.length;n++){var a="";for(var i in t[n])""!==a&&(a+="\t"),a+=t[n][i];r+="".concat(a,"\r\n")}return r}(JSON.stringify(t)),a=r?"".concat(r,".txt"):"export.txt",i=new Blob([n],{type:"text/plain;charset=utf-8;"}),c=document.createElement("a");if(void 0!==c.download){var o=URL.createObjectURL(i);c.setAttribute("href",o),c.setAttribute("download",a),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}var se=function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),r=t[0],i=t[1],c=Object(a.useState)([]),o=Object(p.a)(c,2),d=o[0],b=o[1],m=Object(a.useState)([]),h=Object(p.a)(m,2),j=h[0],O=h[1],g=Object(a.useState)([]),y=Object(p.a)(g,2),x=y[0],w=y[1],S=Object(a.useState)({}),A=Object(p.a)(S,2),k=A[0],F=A[1],M=Object(a.useState)({}),D=Object(p.a)(M,2),I=D[0],C=D[1];return Object(a.useEffect)((function(){console.log(k),console.log(I)}),[k,I]),Object(a.useEffect)((function(){var e,t=localStorage.getItem("visibilitySettings");try{e=JSON.parse(t)}catch(r){e=[]}b(e)}),[]),Object(a.useEffect)((function(){var e,t=localStorage.getItem("mappings");try{e=JSON.parse(t)}catch(r){e=[]}F(e)}),[]),Object(a.useEffect)((function(){var e,t=localStorage.getItem("values");try{e=JSON.parse(t)}catch(r){e=[]}C(e)}),[]),Object(a.useEffect)((function(){localStorage.setItem("visibilitySettings",JSON.stringify(d||[]))}),[d]),Object(a.useEffect)((function(){localStorage.setItem("mappings",JSON.stringify(k||{}))}),[k]),Object(a.useEffect)((function(){localStorage.setItem("values",JSON.stringify(I||{}))}),[I]),Object(n.jsx)("div",{className:"app",children:Object(n.jsxs)("form",{children:[Object(n.jsxs)("label",{htmlFor:"template",children:["Upload Template File",Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{id:"template",type:"file",name:"template",onChange:function(e){var t;(t=e.target.files[0],ce(t,{dateFormat:"DD/MM/YYYY"}).then((function(e){return Object(p.a)(e,1)[0]})).catch(console.log)).then(i)}})]}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsxs)("label",{htmlFor:"mail_manifest",children:["Upload Mail Manifest",Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{id:"mail_manifest",type:"file",name:"mail_manifest",onChange:function(e){var t;(t=e.target.files[0],ce(t).then((function(e){var t=Object(f.a)(e),r=t[0],n=t.slice(1).map((function(e){return e.reduce((function(e,t,n){var a=t;return a instanceof Date&&(a=function(e){var t=""+(e.getMonth()+1),r=""+e.getDate(),n=e.getFullYear();return t.length<2&&(t="0"+t),r.length<2&&(r="0"+r),[n,t,r].join("-")}(a)),Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},r[n],a))}),{})}));return[r,n]})).catch(console.log)).then((function(e){var t=Object(p.a)(e,2),r=t[0],n=t[1];O(r),w(n)}))}})]}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),r.length>0&&Object(n.jsx)(v,{addMapping:function(e,t){F((function(r){return Object(s.a)(Object(s.a)({},r),{},Object(u.a)({},e,t))}))},addValue:function(e,t){C((function(r){return Object(s.a)(Object(s.a)({},r),{},Object(u.a)({},e,t))}))},mailManifestHeaders:j,mappings:k,templateHeaders:r,toggleColumn:function(e){var t=e.target.id.split("_"),r=Object(f.a)(t).slice(1).join("_");b((function(e){var t=Object(l.a)(e),n=e.indexOf(r);return n>-1?t.splice(n,1):t.push(r),t}))},values:I,visibilitySettings:d}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{type:"button",onClick:function(){!function(e,t,r,n){var a=n.map((function(n){return e.reduce((function(e,a){return t[a]||r[a]?Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},a,t[a]?n[t[a]]:r[a])):Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},a,""))}),{})}));ue(e,a)}(r,k,I,x)},children:"Download Amazon Upload File"})})]})})},le=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,41)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),i(e),c(e)}))};o.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(se,{})}),document.getElementById("root")),le()}},[[40,1,2]]]);
//# sourceMappingURL=main.514ba817.chunk.js.map